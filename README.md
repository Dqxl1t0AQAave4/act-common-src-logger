# logger-simple-api

Простейший потокобезопасный логгер.

## logger.h

### Пространства имен

```c++
namespace logger { }
```

### Типы

```c++
using logger_t = std::function < void(CString) > ;
```

> Логгер-функция. Данная функция будет вызываться всякий раз при вызове логирующего метода. Единственный параметр -- полностью отформатированная строка.

> Код функции будет вызван под единым для всего логгера мьютексом.

> Значение по умолчанию -- пустая функция `[] (CString) { }`.

### Функции

Все функции являются потокобезопасными -- блокируются общим мьютексом.

```c++
void log(CString s, ...);
```

> Передает логгер-функции строку, являющуюся результатом применения `CString:Format` с переданными аргументами.

```c++
void log_system_error(DWORD error_message_code);
```

> Передает логгер-функции отформатированную WinAPI строку, соответствующую переданному коду ошибки.

```c++
void set(logger_t logger);
```

> Устанавливает логгер-функцию.

## Примеры использования

```c++
/* Установка логгер-функции */
logger::set([] (CString s) { std::cout << s; });

//...

/* Если какая-нибудь WinAPI-функция завершится неудачей */
if (!SomeWinAPIFunction())
{
    DWORD error_message_code = GetLastError();
    
    /* Залогируем эту неудачу */
    logger::log("Error occurred in module %s", MODULE_NAME);
    logger::log_system_error(error_message_code);
}

//...

/**
 * Обнуление логгер-функции для устранения
 * нежелательных эффектов при завершении приложения.
 */
logger::set([] (CString) { });
```